SELECT st_names.nodeid::int "NODEID", array_agg(street) "STREET NAMES", ST_X(geom) "X",  ST_Y(geom) "Y"
FROM (SELECT distinct nodeidfrom nodeid, street, featuretyp
      FROM lion 
      WHERE nodeidfrom::int in (21798, 20335, 20814, 20812, 20734, 20341, 20558, 20904, 20644, 20469, 20735, 92143, 92646, 9037792, 20911, 20742, 20468, 20984, 20813, 20738, 20979, 20466, 20465, 20464, 20905, 20647, 20982, 20817, 20806, 20733, 20338, 20555, 20549, 20461, 20460, 20467, 20731, 20556, 20339, 20557, 20816, 20462, 20811, 20648, 21795, 92593, 20908, 21796, 20730, 20463, 20985, 20907, 20333)

      UNION

      SELECT DISTINCT nodeidto nodeid, street, featuretyp
      FROM lion 
      WHERE nodeidto::int in (21798, 20335, 20814, 20812, 20734, 20341, 20558, 20904, 20644, 20469, 20735, 92143, 92646, 9037792, 20911, 20742, 20468, 20984, 20813, 20738, 20979, 20466, 20465, 20464, 20905, 20647, 20982, 20817, 20806, 20733, 20338, 20555, 20549, 20461, 20460, 20467, 20731, 20556, 20339, 20557, 20816, 20462, 20811, 20648, 21795, 92593, 20908, 21796, 20730, 20463, 20985, 20907, 20333)
) st_names
LEFT JOIN node n
ON n.nodeid::int = st_names.nodeid::int
WHERE featuretyp in ('0', '6', 'C')
GROUP BY st_names.NODEID,  ST_X(geom),  ST_Y(geom)